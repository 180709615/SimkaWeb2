@model TrRiwayatPendidikanForm


@{

    Layout = "~/Views/Shared/_LayoutDynamic.cshtml";
}



<div class="content-wrapper">
    <section class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h3>Add Edit Riwayat Pendidikan</h3>
                </div>
               
            </div>
        </div><!-- /.container-fluid -->
    </section>
    <section class="content">
        <div class="container-fluid">


            <hr />
            <br />
            @*<h3 class="card-title">Add or Edit Studi Lanjut</h3>*@

            <form method="post" asp-action="AddEditRiwayatPendidikan" enctype="multipart/form-data" id="form">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                <input type="hidden" asp-for="IdTrRp" />

                <div class="form-group">
                    <label class="control-label">NPP</label>
                    <input asp-for="Npp" class="form-control" />
                    <span asp-validation-for="Npp" class="text-danger"></span>
                    <span class="text-danger">@TempData["NPPError"]</span>


                </div>
                <div class="form-group">
                    <label class="control-label">Jenjang</label>
                    <select asp-for="IdRefJenjang" class="form-control"
                            asp-items="@(new SelectList(Model.jenjang,"IdRefJenjang","Deskripsi"))">
                        <option value="" disabled selected>Please select one</option>
                    </select>
                    <span asp-validation-for="IdRefJenjang" class="text-danger"></span>

                </div>
                <div class="form-group">
                    <label class="control-label">Status Studi</label>
                    <select asp-for="IdRefSs" class="form-control"
                            asp-items="@(new SelectList(Model.StatusStudi,"IdRefSs","Deskripsi"))">
                        <option value="" disabled selected>Please select one</option>
                    </select>
                    <span asp-validation-for="IdRefSs" class="text-danger"></span>

                </div>
                <div class="form-group row">
                    <div class="col-3">
                        <label asp-for="NamaSekolah" class="control-label">Nama Sekolah</label>
                        <input asp-for="NamaSekolah" class="form-control" />
                        <span asp-validation-for="NamaSekolah" class="text-danger"></span>
                    </div>
                    <div class="col-3">
                        <label asp-for="Fakultas" class="control-label">Fakultas</label>
                        <input asp-for="Fakultas" class="form-control" />
                        <span asp-validation-for="Fakultas" class="text-danger"></span>
                    </div>
                    <div class="col-3">
                        <label asp-for="Jurusan" class="control-label">Jurusan</label>
                        <input asp-for="Jurusan" class="form-control" />
                        <span asp-validation-for="Jurusan" class="text-danger"></span>
                    </div>
                    <div class="col-3">
                        <label asp-for="ProgramStudi" class="control-label">Program Studi</label>
                        <input asp-for="ProgramStudi" class="form-control" />
                        <span asp-validation-for="ProgramStudi" class="text-danger"></span>
                    </div>

                </div>
                <div class="form-group row">
                    <div class="col-6">
                        <label asp-for="NoIjazah" class="control-label">No. Ijazah</label>
                        <input asp-for="NoIjazah" class="form-control" />
                        <span asp-validation-for="NoIjazah" class="text-danger"></span>
                    </div>
                    <div class="col-6">
                        <label asp-for="TglIjazah" class="control-label">Tanggal Ijazah</label>
                        <input asp-for="TglIjazah" type="date" class="form-control" />
                        <span asp-validation-for="TglIjazah" class="text-danger"></span>
                    </div>


                </div>


                <div class="form-group">
                    <label asp-for="Ipk" class="control-label">IPK</label>
                    <input type="number" asp-for="Ipk" class="form-control" />
                    <span asp-validation-for="Ipk" min="0" max="4" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="Gelar" class="control-label"> Gelar</label>
                    <input asp-for="Gelar" class="form-control" />
                    <span asp-validation-for="Gelar" class="text-danger"></span>
                </div>

                <div class="form-group row">
                    <div class="col-6">
                        <label asp-for="TahunMasuk" class="control-label">Tahun Masuk</label>
                        <input asp-for="TahunMasuk" type="number" min="1900" max="2100" class="form-control" />
                        <span asp-validation-for="TahunMasuk" class="text-danger"></span>
                    </div>
                    <div class="col-6">
                        <label asp-for="TahunLulus" class="control-label">Tahun Lulus</label>
                        <input asp-for="TahunLulus" type="number" min="1900" max="2100" class="form-control" />
                        <span asp-validation-for="TahunLulus" class="text-danger"></span>
                    </div>
                </div>

                <div class="form-group">
                    <label asp-for="AsalBeasiswa" class="control-label">Asal Beasiswa</label>
                    <input asp-for="AsalBeasiswa" class="form-control" />
                    <span asp-validation-for="AsalBeasiswa" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label asp-for="Keterangan" class="control-label">Keterangan</label>
                    <textarea asp-for="Keterangan" class="form-control" rows="2"></textarea>
                    <span asp-validation-for="Keterangan" class="text-danger"></span>
                </div>

                <div class="form-group ">
                    <label for="ScanIjazahForm" class="control-label">File Ijazah</label>
                    <input asp-for="ScanIjazahForm" type="file" class="form-control-file">
                    <div id="previewFoto">
                        @if (Model.ScanIjazah != null)
                        {
            <img src="data:image/jpeg;base64,@System.Convert.ToBase64String(Model.ScanIjazah) " width="300" height="300">}
                    </div>
                </div>
                <div class="form-group ">
                    <label for="ScanTranskripForm" class="control-label">File Transkrip</label>
                    <input asp-for="ScanTranskripForm" type="file" class="form-control-file">
                    <div id="previewAsuransi">
                        @if (Model.ScanTranskrip != null)
                        {
            <img src="data:image/jpeg;base64,@System.Convert.ToBase64String(Model.ScanTranskrip) " width="300" height="300">}
                    </div>
                </div>
                <div class="form-group">
                    <button type="button" id="btnSave" value="Save" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </section>
</div>
@section Scripts{
    <script>
        function previewFoto() {

            var preview = document.querySelector('#previewFoto');

            if (this.files) {
                [].forEach.call(this.files, readAndPreview);
            }

            function readAndPreview(file) {


                // Make sure `file.name` matches our extensions criteria
                if (!/\.(jpe?g|)$/i.test(file.name)) {
                    document.getElementById("ScanIjazahForm").value = "";
                    $("#previewAsuransi").empty();
                    return alert(file.name + " bukan JPG");
                } // else...
                if (file.size > 1024000) {
                    document.getElementById("ScanIjazahForm").value = "";
                    $("#previewAsuransi").empty();
                    return alert(file.name + " Lebih dari 1MB");
                } // else...

                var reader = new FileReader();

                reader.addEventListener("load", function () {
                    var image = new Image();
                    image.height = 200;
                    image.title = file.name;
                    image.src = this.result;
                    $("#previewAsuransi").empty();
                    preview.append(image);

                });

                reader.readAsDataURL(file);
            }
        }

        document.querySelector('#ScanIjazahForm').addEventListener("change", previewFoto);
        function previewAsuransi() {

            var preview = document.querySelector('#previewAsuransi');

            if (this.files) {
                [].forEach.call(this.files, readAndPrevieww);
            }

            function readAndPrevieww(file) {


                // Make sure `file.name` matches our extensions criteria
                if (!/\.(jpe?g|)$/i.test(file.name)) {
                    document.getElementById("ScanTranskripForm").value = "";
                    $("#ScanTranskripForm").empty();
                    return alert(file.name + " bukan JPG");
                } // else...
                if (file.size > 1024000) {
                    document.getElementById("ScanTranskripForm").value = "";
                    $("#ScanTranskripForm").empty();
                    return alert(file.name + " Lebih dari 1MB");
                } // else...

                var reader = new FileReader();

                reader.addEventListener("load", function () {
                    var image = new Image();
                    image.height = 200;
                    image.title = file.name;
                    image.src = this.result;
                    $("#previewAsuransi").empty();
                    preview.append(image);

                });

                reader.readAsDataURL(file);
            }
        }

        document.querySelector('#ScanTranskripForm').addEventListener("change", previewAsuransi);

        $("#btnSave").click(function (e) {
            e.preventDefault();
            Swal.fire({
                title: 'Apakah data yang Anda isi sudah benar?',
                //text: "No SK tidak dapat dirubah setelah disimpan",
                showCancelButton: true,
                confirmButtonText: 'Ya',
                denyButtonText: `Tidak`,
            }).then((result) => {
                if (result.isConfirmed) {

                    $("form").submit()
                } else {
                    return false;
                }

            });

        });
    </script>
}
